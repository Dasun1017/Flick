<!--<!DOCTYPE html>

Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
Click nbfs://nbhost/SystemFileSystem/Templates/JSP_Servlet/Html.html to edit this template

<html>
    <head>
        <title>TODO supply a title</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
    </head>
    <body>
        <div>TODO write content</div>
    </body>
</html>-->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Movie Seat Booking</title>
    <style>
        .seat-grid {
            display: grid;
            grid-template-columns: repeat(10, 1fr);
            gap: 10px;
            width: 50%;
            margin: auto;
        }

        .seat {
            width: 40px;
            height: 40px;
            background-color: #ccc;
            border: 1px solid #888;
            text-align: center;
            line-height: 40px;
            cursor: pointer;
        }

        .seat.booked {
            background-color: red;
            cursor: not-allowed;
        }

        .seat.selected {
            background-color: green;
        }
    </style>
</head>
<body>
    <h1 style="text-align:center;">Select Your Seats</h1>
    <div class="seat-grid" id="seatGrid">
        <!-- Seats will be dynamically generated by JavaScript -->
    </div>
    <button id="confirmBooking" style="display: block; margin: 20px auto;">Confirm Booking</button>

    <script>
        const seatGrid = document.getElementById('seatGrid');
        const confirmBooking = document.getElementById('confirmBooking');
        let selectedSeats = [];

        // Generate seat grid
        for (let i = 0; i < 100; i++) {
            const seat = document.createElement('div');
            seat.classList.add('seat');
            seat.setAttribute('data-seat-id', i + 1);
            seat.addEventListener('click', () => selectSeat(seat));
            seatGrid.appendChild(seat);
        }

        // Mark booked seats (replace with actual data from the server)
        const bookedSeats = [5, 12, 45]; // Example
        bookedSeats.forEach(seatId => {
            const seat = document.querySelector(`[data-seat-id='${seatId}']`);
            if (seat) seat.classList.add('booked');
        });

        function selectSeat(seat) {
            if (seat.classList.contains('booked')) return;

            seat.classList.toggle('selected');
            const seatId = parseInt(seat.getAttribute('data-seat-id'));
            if (seat.classList.contains('selected')) {
                selectedSeats.push(seatId);
            } else {
                selectedSeats = selectedSeats.filter(id => id !== seatId);
            }
        }

        confirmBooking.addEventListener('click', () => {
            fetch('/bookSeats', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ seats: selectedSeats })
            })
                .then(response => response.json())
                .then(data => {
                    alert(data.message);
                    if (data.success) {
                        selectedSeats.forEach(seatId => {
                            const seat = document.querySelector(`[data-seat-id='${seatId}']`);
                            seat.classList.add('booked');
                            seat.classList.remove('selected');
                        });
                        selectedSeats = [];
                    }
                });
        });
    </script>
</body>
</html>
